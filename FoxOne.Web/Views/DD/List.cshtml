@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv=Content-Type content="text/html;charset=utf-8">
    <meta charset="gbk">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection" />
    <meta content="yes" name="apple-touch-fullscreen" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>跳转中</title>
    <script>
        var _config = @Html.Raw(FoxOne.Core.JSONHelper.Serialize(FoxOne.Business.DDSDK.DDHelper.FetchSignPackage(HttpContext.Current.Request.Url.AbsoluteUri)))   ;
    </script>
</head>
<body>

    <script src="~/Scripts/zepto.min.js"></script>
    <script type="text/javascript" src="http://g.alicdn.com/dingding/open-develop/1.6.9/dingtalk.js"></script>

    <script>

        var logger = { i: function (info) { }, e: function (err) { dd.device.notification.alert({ message: err, title: '异常提示', buttonName: '关闭' }) } };

        /*dd.config({
            agentId: _config.agentId,
            corpId: _config.corpId,
            timeStamp: _config.timeStamp,
            nonceStr: _config.nonceStr,
            signature: _config.signature,
            jsApiList: ['runtime.info', 'biz.contact.choose',
                'device.notification.confirm', 'device.notification.alert',
                'device.notification.prompt', 'biz.ding.post', 'biz.util.scanCard',
                'biz.util.openLink']
        });*/

        dd.ready(function () {
            dd.runtime.permission.requestAuthCode({
                corpId: '@(FoxOne.Business.DDSDK.DDHelper.FetchCorpID())',//_config.corpId,
                onSuccess: function (info) {
                    $.ajax({
                        url: '/DD/Get/' + info.code,
                        type: 'GET',
                        success: function (data, status, xhr) {
                            var info = JSON.parse(data);
                            //dd.biz.util.openLink({
                            //    url: 'http://www.foxone.cc/Mobile/Index'
                            //});
                            location="http://www.foxone.cc/Mobile/Index";
                        },
                        error: function (xhr, errorType, error) {
                            logger.e(errorType + ', ' + error);
                        }
                    });

                },
                onFail: function (err) {
                    logger.e('fail: ' + JSON.stringify(err));
                }
            });
        });

        dd.error(function (err) {
            logger.e('dd error: ' + JSON.stringify(err));
        });

    </script>
</body>
</html>
